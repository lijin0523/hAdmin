<!DOCTYPE html>
<html>
<head>
<title>供配电</title>
<link rel="stylesheet" href="assets/plugins/zTree/css/metroStyle/metroStyle.css" type="text/css">
<link rel="stylesheet" type="text/css" href="assets/plugins/DateTimePicker-master/src/DateTimePicker.css"/>
<style>
        body {
            font-family: Verdana, Arial, Helvetica, AppleGothic, sans-serif;
        }

        .caption {
            float: left;
            display: inline-block;
            font-size: 18px;
            line-height: 18px;
            padding: 10px 0;
        }

        .actions {
            float: right;
            display: inline-block;
            padding: 6px 0;
        }

        .nav-tabs > li > a {
            text-decoration: none;
        }

        .nav-tabs > li.active > a, .nav-tabs > li.active > a:focus, .nav-tabs > li.active > a:hover {
            color: #fff;
            background-color: #337ab7;
            cursor: default;

        }

        .nav > li > a:focus, .nav > li > a:hover {
            text-decoration: none;
            background-color: #eee;
            color: #555555;
        }

        .tabs-left.nav-tabs {
            border-right: 1px solid rgb(10, 167, 112);
        }

        .tabs-left.nav-tabs > li.active > a, .tabs-left.nav-tabs > li.active > a:hover > li.active > a:focus {
            -webkit-border-radius: 4px 0 0 4px;
            -moz-border-radius: 4px 0 0 4px;
            -ms-border-radius: 4px 0 0 4px;
            -o-border-radius: 4px 0 0 4px;
            border-radius: 4px 0 0 4px;
            border-color: #ddd transparent #ddd rgb(10, 167, 112);
        }

    </style>
</head>
<body>
<div class="row">
  <div class="modal-dtpicker"></div>
  <div class="col-lg-3 col-md-3 col-sm-6">
    <div class="dashboard-stat2 ">
      <div class="">
        <div class=" ">
          <h4 class="font-green-sharp bold"> 设备选择</h4>
        </div>
        <hr style="width: 100%;"/>
      </div>
      <div class="zTreeDemoBackground left">
        <ul id="tree" class="ztree" style="width:100%; height:auto;overflow:auto;">
        </ul>
      </div>
    </div>
  </div>
  <input type="hidden" name="tabId" id="tabId"/>
  <input type="hidden" name="companyId" id="companyId"/>
  <div class="col-lg-9  col-md-9 col-sm-9">
    <div class="portlet light ">
      <div class="portlet-body box ">
        <div class="portlet " >
          <div class="portlet-body" style="display: block;">
            <div class="row">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <ul class="nav nav-tabs" id="stab">
                  <li class="active" id="one1" onClick="setTab('one',1,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="true"> 负荷 </a> </li>
                  <li class="" id="one2" onClick="setTab('one',2,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="false"> 电流 </a> </li>
                  <li class="" id="one3" onClick="setTab('one',3,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="false"> 电压</a> </li>
                  <li class="" id="one4" onClick="setTab('one',4,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="false"> 温度</a> </li>
                  <li class="" id="one5" onClick="setTab('one',5,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="false">漏电</a> </li>
                  <li class="" id="one6" onClick="setTab('one',6,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="false">功率因数</a> </li>
                  <li class="" id="one7" onClick="setTab('one',7,8)" style="display:none"> <a href="" data-toggle="tab" aria-expanded="false"> 状态</a> </li>
                </ul>
              </div>
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="tab-content">
                  <div class="tab-pane" id="tab_one_1" style="display:none;">
                    <div class="portlet-title">
                      <div class="caption"> <span class="caption-subject bold uppercase ">状态:</span> <span class="caption-helper font-green" id="state"> </span> </div>
                      <div class="actions"><span class="bold">数据更新时间:</span> <span class="font-blue" id="refreshDateDiv_1">2018-06-14 03:45:33</span> &nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn red-mint btn-xs"
                                                        onclick="refreshData(1);">刷新 </button>
                      </div>
                    </div>
                    <div class="row" style="margin-right:0px;margin-left: 0px;">
                      <div class="table-scrollable">
                        <table class="table table-bordered ">
                          <thead class="label-success">
                            <tr style="color: #FFF;">
                              <th colspan="4" class="text-center "> 有功功率(kW)</th>
                              <th colspan="4" class="text-center"> 无功功率(kVar)</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr class="text-center label-success">
                              <td> 总</td>
                              <td> A相</td>
                              <td> B相</td>
                              <td> C相</td>
                              <td> 总</td>
                              <td> A相</td>
                              <td> B相</td>
                              <td> C相</td>
                            </tr>
                            <tr class="text-center">
                              <td><span id="zyggl"> ~ </span></td>
                              <td><span id="yga"> ~ </span></td>
                              <td><span id="ygb"> ~ </span> </td>
                              <td><span id="ygc"> ~ </span></td>
                              <td><span id="zwggl"> ~ </span></td>
                              <td><span id="wga"> ~ </span></td>
                              <td><span id="wgb"> ~ </span></td>
                              <td><span id="wgc"> ~ </span></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                    <div class="row ">
                      <div class="col-md-5 col-xs-2"></div>
                      <div class="col-md-7 col-xs-10">
                        <input type="hidden" id="deviceId_1" name="deviceId_1"/>
                        <div class="col-md-6 col-md-push-4 col-xs-7 col-xs-push-2">
                          <input type="text" class="form-control" data-field="date"
                                                           data-format="yyyy-MM-dd" name="startTime_1"
                                                           id="startTime_1" readonly="readonly"/>
                        </div>
                        <div class="col-md-1 col-md-push-3 col-xs-1">
                          <button type="button" class="btn red-mint" onClick="changeTime(1);"> 查询 </button>
                        </div>
                      </div>
                    </div>
                    <br/>
                    <div class="row">
                      <p class="text-center"><strong><b>近两日总负荷对比</b></strong>
                      <p>
                      <div id="main_1" style="width: 100%;height:100%; margin:0 auto;"> </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                  </div>
                  <div class="tab-pane" id="tab_one_2" style="display:none;">
                    <div class="portlet-title">
                      <div class="caption" s><span
                                                    class="caption-subject bold uppercase ">状态:</span> <span class="caption-helper font-green" id="state1"></span></div>
                      <div class="actions"><span class="bold">数据更新时间:</span> <span class="font-blue" id="refreshDateDiv_2">2018-06-14 03:45:33</span> &nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn red-mint btn-xs"
                                                        onclick="refreshData(2);">刷新 </button>
                      </div>
                    </div>
                    <div class="row" style="margin-right:0px;margin-left: 0px;">
                      <div class="table-scrollable">
                        <table class="table table-bordered ">
                          <tbody>
                            <tr class="text-center label-success">
                              <td>电流Ia(A)</td>
                              <td>电流Ib(A)</td>
                              <td>电流Ic(A)</td>
                              <td>电流In(A)</td>
                            </tr>
                            <tr class="text-center">
                              <td><span id="dla"> ~ </span></td>
                              <td><span id="dlb"> ~ </span></td>
                              <td><span id="dlc"> ~ </span> </td>
                              <td><span id="dln"> ~ </span></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                    <div class="row " style="margin-right:0px;margin-left: 0px;">
                      <input type="hidden" id="deviceId_2" name="deviceId_2"/>
                      <div class="col-md-6" style="padding:0!important;">
                        <div class="btn-group btn-group-xs btn-group-solid">
                          <button type="button" onClick="getByeHour('1','101','2','2','hour')"
                                                            class="btn red">1小时 </button>
                          <button type="button" onClick="getByeHour('6','101','2','2','hour')"
                                                            class="btn green">6小时 </button>
                          <button type="button"
                                                            onclick="getByeHour('12','101','2','2','hour')"
                                                            class="btn blue">12小时 </button>
                          <button type="button" onClick="getByeHour('24','101','2','2','day')"
                                                            class="btn red">1天 </button>
                          <button type="button" onClick="getByeHour('72','101','2','2','day')"
                                                            class="btn green">3天 </button>
                          <button type="button"
                                                            onclick="getByeHour('168','101','2','2','day')"
                                                            class="btn blue">7天 </button>
                        </div>
                      </div>
                      <div  
                                                    style="padding-left:0!important;padding-right:0px !important;padding-top:2px;width:330px;float:right;">
                        <div style="float:left;width:120px;height:34px;">
                          <input type="text" class="form-control" data-field="date"
                                                           data-format="yyyy-MM-dd" name="startTime_2" id="startTime_2"
                                                           readonly="">
                        </div>
                        <div style="float:left; ling-height:34px;height:34px;padding-top: 6px"> &nbsp;&nbsp;至&nbsp;&nbsp; </div>
                        <div style="width:120px;height:34px;float:left">
                          <input type="text" class="form-control" data-field="date"
                                                           data-format="yyyy-MM-dd" name="endTime_2" id="endTime_2"
                                                           readonly="">
                        </div>
                        <div style="width:50px;height:34px;line-height:34px;float:right;">
                          <button style="width:50px;height:34px;line-height:34px;float:right;"
                                                            type="button" class="btn red-mint btn-xs"
                                                            onclick="changeTime(2);">查询 </button>
                        </div>
                      </div>
                    </div>
                    <br/>
                    <div class="row">
                      <p class="text-center"><strong><b>电流对比</b></strong>
                      <p>
                      <div id="main_2" style="width: 100%;height:100%; margin:0 auto;"> </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                  </div>
                  <div class="tab-pane" id="tab_one_3" style="display:none;">
                    <div class="portlet-title">
                      <div class="caption" s><span
                                                    class="caption-subject bold uppercase ">状态:</span> <span class="caption-helper font-green" id="state2"></span></div>
                      <div class="actions"><span class="bold">数据更新时间:</span> <span class="font-blue" id="refreshDateDiv_3">2018-06-14 03:45:33</span> &nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn red-mint btn-xs"
                                                        onclick="refreshData(3);">刷新 </button>
                      </div>
                    </div>
                    <div class="row" style="margin-right:0px;margin-left: 0px;">
                      <div class="table-scrollable">
                        <table class="table table-bordered ">
                          <tbody>
                            <tr class="text-center label-success">
                              <td>相电压Uan(V)</td>
                              <td>相电压Ubn(V)</td>
                              <td>相电压Ucn(V)</td>
                            </tr>
                            <tr class="text-center">
                              <td><span id="xdya"> ~ </span></td>
                              <td><span id="xdyb"> ~ </span></td>
                              <td><span id="xdyc"> ~ </span> </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                    <div class="row " style="margin-right:0px;margin-left: 0px;">
                      <input type="hidden" id="deviceId_3" name="deviceId_3"/>
                      <div class="col-md-6" style="padding:0!important;">
                        <div class="btn-group btn-group-xs btn-group-solid">
                          <button type="button" onClick="getByeHour('1','115','3','3','hour')"
                                                            class="btn red">1小时 </button>
                          <button type="button" onClick="getByeHour('6','115','3','3','hour')"
                                                            class="btn green">6小时 </button>
                          <button type="button"
                                                            onclick="getByeHour('12','115','3','3','hour')"
                                                            class="btn blue">12小时 </button>
                          <button type="button" onClick="getByeHour('24','115','3','3','day')"
                                                            class="btn red">1天 </button>
                          <button type="button" onClick="getByeHour('72','115','3','3','day')"
                                                            class="btn green">3天 </button>
                          <button type="button"
                                                            onclick="getByeHour('168','115','3','3','day')"
                                                            class="btn blue">7天 </button>
                        </div>
                      </div>
                      <div  style="padding-left:0!important;padding-right:0px !important;padding-top:2px;width:330px;float:right;">
                        <div style="float:left;width:120px;height:34px;">
                          <input type="text" class="form-control" data-field="date"
                                                           data-format="yyyy-MM-dd" name="startTime_3" id="startTime_3"
                                                           readonly="">
                        </div>
                        <div style="float:left;  ling-height:34px;height:34px;padding-top: 6px"> &nbsp;&nbsp;至&nbsp;&nbsp; </div>
                        <div style="width:120px;height:34px;float:left">
                          <input type="text" class="form-control" data-field="date"
                                                           data-format="yyyy-MM-dd" name="endTime_3" id="endTime_3"
                                                           readonly="">
                        </div>
                        <div style="width:50px;height:34px;line-height:34px;float:right;">
                          <button style="width:50px;height:34px;line-height:34px;float:right;"
                                                            type="button" class="btn red-mint btn-xs"
                                                            onclick="changeTime(3);">查询 </button>
                        </div>
                      </div>
                    </div>
                    <br/>
                    <div class="row">
                      <p class="text-center"><strong><b>电压对比</b></strong>
                      <p>
                      <div id="main_3" style="width: 100%;height:100%; margin:0 auto;"> </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                  </div>
                  <div class="tab-pane" id="tab_one_4" style="display:none;">
                    <div class="portlet-title">
                      <div class="caption"><span
                                                    class="caption-subject bold uppercase ">状态:</span> <span class="caption-helper font-green" id="state3"></span></div>
                      <div class="actions"><span class="bold">数据更新时间:</span> <span class="font-blue" id="refreshDateDiv_4">2018-06-14 03:45:33</span> &nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn red-mint btn-xs"
                                                        onclick="refreshData(4);">刷新 </button>
                      </div>
                    </div>
                    <div class="row" style="margin: 0px;">
                      <div class="table-scrollable">
                        <table class="table table-bordered ">
                          <tbody id="wdTbody1">
                            <tr class="text-center ">
                              <td class="label-success col-md-5"> 进线N相温度(℃) </td>
                              <td> 27.0 </td>
                            </tr>
                            <tr class="text-center ">
                              <td class="label-success col-md-5"> 进线C相温度(℃) </td>
                              <td> 27.0 </td>
                            </tr>
                            <tr class="text-center ">
                              <td class="label-success col-md-5"> 进线B相温度(℃) </td>
                              <td> 30.0 </td>
                            </tr>
                            <tr class="text-center ">
                              <td class="label-success col-md-5"> 进线A相温度(℃) </td>
                              <td> 29.0 </td>
                            </tr>
                          </tbody>
                          <tbody id="wdTbody">
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <br/>
                    <div class="row " style="margin: 0px;">
                      <div class="col-md-4 col-md-pull-4"></div>
                      <input type="hidden" id="deviceId_4" name="deviceId_4"/>
                      <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">从 </div>
                      <div class="col-md-3">
                        <input type="text" class="form-control" data-field="date"
                                                       data-format="yyyy-MM-dd" name="startTime_4" id="startTime_4"
                                                       readonly="">
                      </div>
                      <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">至 </div>
                      <div class="col-md-3">
                        <input type="text" class="form-control" data-field="date"
                                                       data-format="yyyy-MM-dd" name="endTime_4" id="endTime_4"
                                                       readonly="">
                      </div>
                      <div class="col-md-1" style="padding-left:0px;">
                        <button type="button" class="btn red-mint " onClick="changeTime(4);"> 查询 </button>
                      </div>
                    </div>
                    </br>
                    <div class="row">
                      <p class="text-center"><strong><b>温度对比</b></strong>
                      <p>
                      <div id="main_4" style="width: 100%;height:100%; margin:0 auto;"> </div>
                    </div>
                  </div>
                  <div class="tab-pane" id="tab_one_5" style="display:none;">
                    <div class="portlet-title">
                      <div class="caption" s><span
                                                    class="caption-subject bold uppercase ">状态:</span> <span class="caption-helper font-green" id="state4"></span></div>
                      <div class="actions"><span class="bold">数据更新时间:</span> <span class="font-blue" id="refreshDateDiv_5">2018-06-14 03:45:33</span> &nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn red-mint btn-xs"
                                                        onclick="refreshData(5);">刷新 </button>
                      </div>
                    </div>
                    <div class="row" style="margin: 0px;">
                      <div class="table-scrollable">
                        <table class="table table-bordered ">
                          <tbody>
                            <tr class="text-center ">
                              <td class="label-success col-md-5 col-xs-5" style="margin: 0px;"> 漏电(mA) </td>
                              <td><span id="lddl"> 0.0 </span> </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <br/>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                    <div class="row " style="margin: 0px;">
                      <div class="col-md-5"></div>
                      <div class="col-md-7  ">
                        <input type="hidden" id="deviceId_5" name="deviceId_5"/>
                        <div class="col-md-6 col-md-push-4">
                          <input type="text" class="form-control" data-field="date"
                                                           data-format="yyyy-MM-dd" name="startTime_5"
                                                           id="startTime_5" readonly="readonly"/>
                        </div>
                        <div class="col-md-1 col-md-push-3">
                          <button type="button" class="btn red-mint" onClick="changeTime(5);"> 查询 </button>
                        </div>
                      </div>
                    </div>
                    <br>
                    <div class="row">
                      <p class="text-center"><strong><b>漏电趋势</b></strong>
                      <p>
                      <div id="main_5" style="width: 100%;height:100%; margin:0 auto;"> </div>
                    </div>
                    <div class="progress-info">
                      <div class="progress"> </div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane" id="tab_one_6" style="display:none;">
                  <div class="portlet-title">
                    <div class="caption"><span class="caption-subject bold uppercase ">状态:</span> <span class="caption-helper font-green" id="state5"></span></div>
                    <div class="actions"><span class="bold">数据更新时间:</span> <span class="font-blue" id="refreshDateDiv_6">2018-06-14 03:45:33</span> &nbsp;&nbsp;&nbsp;&nbsp;
                      <button type="button" class="btn red-mint btn-xs" onClick="refreshData(6);"> 刷新 </button>
                    </div>
                  </div>
                  <div class="row" style="margin: 0px;">
                    <div class="table-scrollable">
                      <table class="table table-bordered ">
                        <tbody>
                          <tr class="text-center label-success">
                            <td>总功率因数</td>
                            <td>A相功率因数</td>
                            <td>B相功率因数</td>
                            <td>C相功率因数</td>
                          </tr>
                          <tr class="text-center">
                            <td><span id="glxsz"> ~ </span></td>
                            <td><span id="glxsa"> ~ </span></td>
                            <td><span id="glxsb"> ~ </span> </td>
                            <td><span id="glxsc"> ~ </span></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <br>
                  <div class="progress-info">
                    <div class="progress"> </div>
                  </div>
                  <div class="row " style="margin: 0px;">
                    <div class="col-md-4 col-md-pull-4"></div>
                    <input type="hidden" id="deviceId_6" name="deviceId_6"/>
                    <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">从</div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" data-field="date"
                                                   data-format="yyyy-MM-dd" name="startTime_6" id="startTime_6"
                                                   readonly="">
                    </div>
                    <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">至</div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" data-field="date"
                                                   data-format="yyyy-MM-dd" name="endTime_6" id="endTime_6" readonly="">
                    </div>
                    <div class="col-md-1" style="padding-left:0px;">
                      <button type="button" class="btn red-mint  " onClick="changeTime(6);">查询 </button>
                    </div>
                  </div>
                  <br/>
                  <div class="row">
                    <p class="text-center"><strong><b>功率因数对比</b></strong>
                    <p>
                    <div id="main_6" style="width: 100%;height:100%; margin:0 auto;"> </div>
                  </div>
                  <br>
                  <div class="progress-info">
                    <div class="progress"> </div>
                  </div>
                </div>
                <div class="tab-pane" id="tab_one_7" style="display:none;">
                  <div class="row ">
                    <div class="col-md-4 col-md-pull-4"></div>
                    <input type="hidden" id="deviceId_7" name="deviceId_7"/>
                    <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">从</div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" data-field="date"
                                                   data-format="yyyy-MM-dd" name="startTime_7" id="startTime_7"
                                                   readonly="">
                    </div>
                    <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">至</div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" data-field="date"
                                                   data-format="yyyy-MM-dd" name="endTime_7" id="endTime_7" readonly="">
                    </div>
                    <div class="col-md-1" style="padding-left:0px;">
                      <button type="button" class="btn red-mint " onClick="changeTime(7);">查询 </button>
                    </div>
                  </div>
                  <div class="row" style="margin-right:0px;margin-left: 0px;">
                    <div class="table-scrollable">
                      <table class="table table-bordered " id="table_7">
                        <tbody>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="tab-pane" id="tab_one_8" style="display:none;">
                  <div class="row ">
                    <div class="col-md-4 col-md-pull-4"></div>
                    <input type="hidden" id="deviceId_8" name="deviceId_8"/>
                    <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">从</div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" data-field="date"
                                                   data-format="yyyy-MM-dd" name="startTime_8" id="startTime_8"
                                                   readonly="">
                    </div>
                    <div style="float:left;  ling-height:34px;height:34px;padding-top:6px;">至</div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" data-field="date"
                                                   data-format="yyyy-MM-dd" name="endTime_8" id="endTime_8" readonly="">
                    </div>
                    <button type="button" class="btn red-mint " onClick="changeTime(8);">查询 </button>
                  </div>
                  <div class="row" style="margin-right:0px;margin-left: 0px;">
                    <div class="table-scrollable">
                      <table class="table table-bordered " id="table_8">
                        <tbody>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
<script src="assets/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="assets/plugins/zTree/jquery.ztree.all-3.5.min.js"></script>
<script src="assets/plugins/zTree/jquery.ztree.exhide-3.5.min.js"></script>
<script src="assets/plugins/echarts/echarts.js" type="text/javascript"></script>
<script type="text/javascript" src="assets/plugins/DateTimePicker-master/src/DateTimePicker.js"></script>
<script src="assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
<script type="text/javascript">
    var ztree;
    var isSearch = false;

    $(function () {
        $(".modal-dtpicker").DateTimePicker();
        ztree = $.fn.zTree.init($("#tree"), setting);
        for (var i = 1; i <= 8; i++) {
            $("#startTime_" + i).val('2018-06-14');
            $("#endTime_" + i).val('2018-06-14');
            $("#deviceId_" + i).val(133);
        }
        var type;
        var defaultDeviceId =133;
        //alert(defaultDeviceId);
        if (defaultDeviceId != null && defaultDeviceId != "") {
            $.ajax({
                url: "rest/pointType/getType.do?deviceId=" +133,
                success: function (data) {
                    var data = JSON.parse(data);
                    if (data.fh == 1) {
                        type = 1;
                    } else if (data.dl == 1) {
                        type = 2;
                    } else if (data.dy == 1) {
                        type = 3;
                    } else if (data.wd == 1) {
                        type = 4;
                    } else if (data.lod == 1) {
                        type = 5;
                    } else if (data.gl == 1) {
                        type = 6;
                    } else if (data.zt == 1) {
                        type = 7;
                    } else {
                        type = 8;
                    }
                    setTab('one', type, 8);
                }
            })
        }

    });


    function setTab(name, cursel, n) {
        // aria-expanded="true"
        //debugger;
        var did = $("#deviceId_" + cursel).val();
        var startTime = $("#startTime_" + cursel).val();
        var endTime = $("#endTime_" + cursel).val();
        switch (cursel) {
            case 1:
                getTwoData(did, startTime, startTime, "103", 1);
                $("#tabId").val(1);
                break;
            case 2:
                getTwoData(did, startTime, endTime, "101", 2);
                $("#tabId").val(2);
                break;
            case 3:
                getTwoData(did, startTime, endTime, "115", 3);
                $("#tabId").val(3);
                break;
            case 4:
                getTwoData(did, startTime, endTime, "105", 4);
                $("#tabId").val(4);
                break;
            case 5:
                getTwoData(did, startTime, startTime, "104", 5);
                $("#tabId").val(5);
                break;
            case 6:
                getTwoData(did, startTime, endTime, "107", 6);
                $("#tabId").val(6);
                break;
            case 7:
                getTwoData(did, startTime, endTime, "201", 7);
                $("#tabId").val(7);
                break;
            case 8:
                getTwoData(did, startTime, endTime, "206", 8);
                $("#tabId").val(8);
                break;
        }

        for (var i = 1; i <= n; i++) {
            var li = document.getElementById(name + i);
            var con = document.getElementById("tab_" + name + "_" + i);

            if (i == cursel) {
                li.className = "active";
            }else{
                li.className = "";
            }
            con.style.display = i == cursel ? "block" : "none";
        }

    }

    function isShow(deviceId) {
        /*var deviceId = $("#deviceId_" + cursel).val();
         var startTime = $("#startTime_" + cursel).val();*/
        $.ajax({
            url: "rest/pointType/getType.do?deviceId=" + deviceId,
            success: function (data) {
                var data = JSON.parse(data);

                if (data.fh == 1) {
                    document.getElementById("one1").style.display = "none";
                } else {
                    document.getElementById("one1").style.display = "";
                }

                if (data.dl == 1) {
                    document.getElementById("one2").style.display = "none";
                } else {
                    document.getElementById("one2").style.display = "";
                }

                if (data.dy == 1) {
                    document.getElementById("one3").style.display = "none";
                } else {
                    document.getElementById("one3").style.display = "";
                }

                if (data.wd == 1) {
                    document.getElementById("one4").style.display = "none";
                } else {
                    document.getElementById("one4").style.display = "";
                }

                if (data.lod == 1) {
                    document.getElementById("one5").style.display = "none";
                } else {
                    document.getElementById("one5").style.display = "";
                }

                if (data.gl == 1) {
                    document.getElementById("one6").style.display = "none";
                } else {
                    document.getElementById("one6").style.display = "";
                }

                if (data.zt == 1) {
                    document.getElementById("one7").style.display = "none";
                } else {
                    document.getElementById("one7").style.display = "";
                }
            }
        })
    }

    var setting = {
        view: {
            selectedMulti: false
        },
        async: {
            enable: true,
            url: "rest/common/getNodes.do?type=02&companyId=" + $("#companyId").val(),
            autoParam: ["id", "level"],
            type: "get"
        },
        data: {
            simpleData: {
                enable: true
            }
        },
        callback: {
            onAsyncSuccess: zTreeOnAsyncSuccess,
            onExpand: function (event, treeId, treeNode) {
                var level = treeNode.level;
            },
            onClick: function (event, treeId, treeNode) {
                //alert(treeNode.id);
                var tabId = $("#tabId").val();
                if (tabId != null && tabId != "") {
                    if (parseInt(tabId) < 7) {
                        refreshData(parseInt(tabId));
                    }
                    var did = $("#deviceId_" + parseInt(tabId)).val();
                    var type;
                    $.ajax({
                        url: "rest/pointType/getType.do?deviceId=" + did,
                        success: function (data) {
                            var data = JSON.parse(data);
                            if (data.fh == 0) {
                                type = 1;
                            } else if (data.dl == 0) {
                                type = 2;
                            } else if (data.dy == 0) {
                                type = 3;
                            } else if (data.wd == 0) {
                                type = 4;
                            } else if (data.lod == 0) {
                                type = 5;
                            } else if (data.gl == 0) {
                                type = 6;
                            } else if (data.zt == 0) {
                                type = 7;
                            }
                            setTab('one', type, 8);
                        }
                    })

                }

            },
            beforeClick: function (treeId, treeNode, clickFlag) {
                var level = treeNode.level;
                if (level < 2) {
                    bootbox.alert({
                        size: 'small',
                        message: "请选择设备!",
                    });
                    return false;
                } else {
                    for (var i = 1; i <= 8; i++) {
                        $("#deviceId_" + i).val(treeNode.id);
                    }
                    return true;
                }
            }
        }
    };


    //树异步加载车辆成功，搜索操作时选中搜索到的树节点
    function zTreeOnAsyncSuccess(event, treeId, treeNode) {
        var node;
        if (isSearch) {
            isSearch = false;
            node = ztree.getNodeByParam("id", "设备", null);
            ztree.checkNode(node, true, true, false);
            node = [];
        }

    }

    function refreshData(index) {
        var deviceId = $("#deviceId_" + index).val();
        if (deviceId == null || deviceId == "") {
            bootbox.alert({
                size: 'small',
                message: "请选择左侧的设备",
            });
        }
        //debugger;


        $.ajax({
            url: "rest/pointType/getNowVal.do?deviceId=" + deviceId,
            success: function (data) {
                var data = JSON.parse(eval(data));
                //alert(data.refreshDate);
                //$("#refreshDateDiv_"+index).html("");
                $("#refreshDateDiv_" + index).html(data.refreshDate);
                //alert(data.zyggl+"-------"+data.zwggl);
                if (data.zyggl != null && data.zyggl != "" && data.zyggl != undefined) {
                    $("#zyggl").html(data.zyggl);
                } else {
                    $("#zyggl").html("~");
                }
                if (data.zwggl != null && data.zwggl != "" && data.zwggl != undefined) {
                    $("#zwggl").html(data.zwggl);
                } else {
                    $("#zwggl").html("~");
                }
                if (data.yga != null && data.yga != "" && data.yga != undefined) {
                    $("#yga").html(data.yga);
                } else {
                    $("#yga").html("~");
                }
                if (data.ygb != null && data.ygb != "" && data.ygb != undefined) {
                    $("#ygb").html(data.ygb);
                } else {
                    $("#ygb").html("~");
                }
                if (data.ygc != null & data.ygc != "" && data.ygc != undefined) {
                    $("#ygc").html(data.ygc);
                } else {
                    $("#ygc").html("~");
                }
                if (data.wga != null && data.wga != "" && data.wga != undefined) {
                    $("#wga").html(data.wga);
                } else {
                    $("#wga").html("~");
                }
                if (data.wgb != null && data.wgb != "" && data.wgb != undefined) {
                    $("#wgb").html(data.wgb);
                } else {
                    $("#wgb").html("~");
                }
                if (data.wgc != null && data.wgc != "" && data.wgc != undefined) {
                    $("#wgc").html(data.wgc);
                } else {
                    $("#wgc").html("~");
                }
                if (data.dla != null && data.dla != "" && data.dla != undefined) {
                    $("#dla").html(data.dla);
                } else {
                    $("#dla").html("~");
                }
                if (data.dlb != null && data.dlb != "" && data.dlb != undefined) {
                    $("#dlb").html(data.dlb);
                } else {
                    $("#dlb").html("~");
                }
                if (data.dlc != null && data.dlc != "" && data.dlc != undefined) {
                    $("#dlc").html(data.dlc);
                } else {
                    $("#dlc").html("~");
                }
                if (data.dln != null && data.dln != "" && data.dln != undefined) {
                    $("#dln").html(data.dln);
                } else {
                    $("#dln").html("~");
                }
                if (data.xdya != null && data.xdya != "" && data.xdya != undefined) {
                    $("#xdya").html(data.xdya);
                } else {
                    $("#xdya").html("~");
                }
                if (data.xdyb != null && data.xdyb != "" && data.xdyb != undefined) {
                    $("#xdyb").html(data.xdyb);
                } else {
                    $("#xdyb").html("~");
                }
                if (data.xdyc != null && data.xdyc != "" && data.xdyc != undefined) {
                    $("#xdyc").html(data.xdyc);
                } else {
                    $("#xdyc").html("~");
                }
                if (data.lddl != null && data.lddl != "" && data.lddl != undefined) {
                    $("#lddl").html(data.lddl);
                } else {
                    $("#lddl").html("~");
                }
                if (data.glxsz != null && data.glxsz != "" && data.glxsz != undefined) {
                    $("#glxsz").html(data.glxsz);
                } else {
                    $("#glxsz").html("~");
                }
                if (data.glxsa != null && data.glxsa != "" && data.glxsa != undefined) {
                    $("#glxsa").html(data.glxsa);
                } else {
                    $("#glxsa").html("~");
                }
                if (data.glxsb != null && data.glxsb != "" && data.glxsb != undefined) {
                    $("#glxsb").html(data.glxsb);
                } else {
                    $("#glxsb").html("~");
                }
                if (data.glxsc != null && data.glxsc != "" && data.glxsc != undefined) {
                    $("#glxsc").html(data.glxsc);
                } else {
                    $("#glxsc").html("~");
                }


                $("#wdTbody").html("");
                $("#wdTbody1").html("");
                var html = "";
                var wdList = eval(data.wdList);
                var value;
                //console.log(wdList);
                for (var i = 0; i < wdList.length; i++) {
                    if (wdList[i].value == null || wdList[i].value == "") {
                        value = "~";
                    } else {
                        value = wdList[i].value;
                    }
                    html += "<tr class='text-center'>";
                    html += "<td class='label-success col-md-5'>" + wdList[i].name + "(℃)" + "</td><td>" + value + "</td>";
                    html += "</tr>";
                }
                $("#wdTbody").append(html);
            }
        });
    }

    function changeTime(index) {
        var startTime = $("#startTime_" + index).val();
        var endTime = $("#endTime_" + index).val();
        var deviceId = $("#deviceId_" + index).val();

        //alert(startTime+"---"+ endTime+"---"+deviceId);
        if (startTime == null || startTime == "") {
            bootbox.alert({
                size: 'small',
                message: "查询时间不能为空",
            });
            return false;
        }
        if (index == 2 || index == 3 || index == 4 || index == 7 || index == 8) {
            if (endTime == null || endTime == "") {
                bootbox.alert({
                    size: 'small',
                    message: "查询时间不能为空",
                });

                return false;
            }
        }


        if (deviceId == null || deviceId == "") {
            bootbox.alert({
                size: 'small',
                message: "请选择左侧的设备",
            });
            return false;
        }
        var type = "";

        switch (index) {
            case 1:
                endTime = startTime;
                type = "103";
                break;
            case 2:
                type = "101";
                break;
            case 3:
                type = "115";
                break;
            case 4:
                type = "105";
                break;
            case 5:
                endTime = startTime;
                type = "104";
                break;
            case 6:
                type = "107";
                break;
            case 7:
                type = "201";
                break;
            case 8:
                type = "206";
                break;
        }
        getTwoData(deviceId, startTime, endTime, type, index);
    }

    function getTwoData(deviceId, startTime, endTime, type, index) {
        isShow(deviceId);
        //debugger;
        if (index == 7 || index == 8) {
            //展示列表

            $.ajax({
                url: "rest/pointType/getDataListByDate.do?deviceId=" + deviceId + "&startDate=" + startTime + "&endDate=" + endTime + "&type=" + type,
                success: function (data) {
                    var data = eval(data);
                    console.log(data);
                    setTimeDataTable("table_" + index, data);
                }
            });

        } else if (index == 2 || index == 3 || index == 4 || index == 6) {
            /**
             * 电流 dl
             * 电压 dy
             * 温度 wd
             * 功率因数 gl
             */
            var sign = "";
            if (index == 2) {
                sign = "dl";
            } else if (index == 3) {
                sign = "dy";
            } else if (index == 4) {
                sign = "wd";
            } else if (index == 6) {
                sign = "gl";
            }
            $.ajax({
                url: "rest/pointType/getElectricityDate.do?deviceId=" + deviceId + "&startDate=" + startTime + "&endDate=" + endTime + "&type=" + sign,
                success: function (data) {
                    var data = JSON.parse(data);
                    //console.log(data);
                    pointState(data.state);
                    initCharts("main_" + index, data.legend, data.series, data.xData, sign);
                }
            });

        } else {
            var sign = "";
            if (index == 1) {
                sign = "fh";
            } else if (index == 5) {
                sign = "ld";
            }
            $.ajax({
                url: "rest/pointType/getDataByDate.do?deviceId=" + deviceId + "&startDate=" + startTime + "&endDate=" + endTime + "&type=" + type,
                success: function (data) {
                    //debugger;
                    var data = JSON.parse(eval(data));
                    //console.log(data);
                    //console.log(data.state);
                    //alert(data);
                    pointState(data.state);
                    initCharts("main_" + index, data.legend, data.series, data.xData, sign);
                }
            });
        }

    }


    function pointState(state) {
        //alert(state);
        //var state = data.state;
        if (state == "0") {
            document.getElementById("state").innerText = "在线";
            document.getElementById("state1").innerText = "在线";
            document.getElementById("state2").innerText = "在线";
            document.getElementById("state3").innerText = "在线";
            document.getElementById("state4").innerText = "在线";
            document.getElementById("state5").innerText = "在线";
        } else if (state == "1") {
            document.getElementById("state").innerText = "离线";
            document.getElementById("state1").innerText = "离线";
            document.getElementById("state2").innerText = "离线";
            document.getElementById("state3").innerText = "离线";
            document.getElementById("state4").innerText = "离线";
            document.getElementById("state5").innerText = "离线";
        } else {
            document.getElementById("state").innerText = "未知";
            document.getElementById("state1").innerText = "未知";
            document.getElementById("state2").innerText = "未知";
            document.getElementById("state3").innerText = "未知";
            document.getElementById("state4").innerText = "未知";
            document.getElementById("state5").innerText = "未知";
        }
    }

    function setTimeDataTable(tableId, data) {
        var tableStr = "";
        tableStr += "<tr>";
        tableStr += "<td class='text-center label-success'>项目名称</td>";
        if (tableId == 'table_7') {
            tableStr += "<td class='text-center label-success'>状态</td>";
        } else {
            tableStr += "<td class='text-center label-success'>当前值</td>";
        }

        tableStr += "<td class='text-center label-success'>更新时间</td>";
        tableStr += "</tr>";
        var len = data.length;
        for (var i = 0; i < len; i++) {
            tableStr += "<tr class='text-center'>";
            tableStr += "<td>" + data[i].name + "</td>";
            if (tableId == 'table_7') {
                var stateStr = "";
                if (data[i].value == "0.0" || data[i].value == "0") {
                    stateStr = "开";
                } else {
                    stateStr = "关";
                }
                tableStr += "<td>" + stateStr + "</td>";
            } else {
                tableStr += "<td>data[i].value</td>";
            }
            tableStr += "<td>" + data[i].time + "</td>";
            tableStr += "</tr>";
        }

        $("#" + tableId).html(tableStr);
    }

    function initOrgData() {
        var json = "";
        $.ajax({
            url: "rest/common/deviceOrg/02",
            async: false,//这里选择异步为false，那么这个程序执行到这里的时候会暂停，等待
            success: function (data) {
                json = data;
            }
        });
        return json;
    }

    function initCharts(div, legend, series, xData, sign) {

        resizeContainer(div);

        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById(div));
        myChart.clear();

        var color = null, unit = "";
        if (sign == 'fh') {
            color = ['#800080', '#1ffb30'];
            unit = "kW";
        }
        if (sign == 'ld') {
            color = ['#800080', '#1ffb30'];
            unit = "mA";
        }
        if (sign == 'dl') {
            color = ['#F3C200', '#1ffb30', '#D91E18'];
            unit = "A";
        }
        if (sign == 'dy') {
            color = ['#F3C200', '#1ffb30', '#D91E18'];
            unit = "V";
        }
        if (sign == 'wd') {
            color = ['#F3C200', '#1ffb30', '#D91E18', '#3598DC', '#F2784B', '#26C281', '#9A12B3'];
            unit = "℃";
        }
        if (sign == 'gl') {
            color = ['#D91E18', '#1ffb30', '#F3C200', '#3598DC'];
            unit = "";
        }

        // 指定图表的配置项和数据
        var option = {
            tooltip: {
                trigger: 'axis'
            },
            grid: {
                y: 80
            },
            legend: {
                data: legend,
                margin: 100
                //itemGap:15
            },
            toolbox: {
                show: false,
                feature: {
                    mark: {show: true},
                    dataView: {show: true, readOnly: false},
                    magicType: {show: true, type: ['line', 'bar']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    boundaryGap: false,
                    data: xData
                    //axisLabel:{interval:0,rotate:48,margin:5,textStyle:{color:"#222"}}
                }
            ],
            yAxis: [
                {
                    name: '单位:(' + unit + ')',
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} '
                    }
                }
            ],
            series: series
        };


        if (color != null) {
            option.color = color;
        }

        //window.onresize = myChart.resize;
        //$("#" + div).resize(myChart.resize);

        window.onresize = function () {
            //重置容器高宽
            resizeContainer();
            myChart.resize();
        };

        myChart.setOption(option);
    }

    function resizeContainer(div) {
        var clientWidth = $("#" + div)[0].clientWidth;
        var clientHeight = clientWidth * 8 / 10;
        $("#" + div)[0].style.width = clientWidth + 'px';
        $("#" + div)[0].style.height = clientHeight + 'px';
    }

    function initTree() {
        var data = eval(eval(initOrgData()));
        var options = {
            showTags: false,
            levels: 3,
            multiSelect: false,
            data: data,
            onNodeSelected: function (event, node) {
                if (node.tags == 1 || node.tags == 2) {
                    for (var i = 1; i <= 8; i++) {
                        $("#deviceId_" + i).val("");
                    }
                }
                if (node.tags == 3) {
                    for (var i = 1; i <= 8; i++) {
                        $("#deviceId_" + i).val(node.id);
                    }
                }
            },
            onNodeUnselected: function (event, node) {
                //alert("未选择"+node.id);
            },
            nodeExpanded: function (event, node) {

            }
        };

        $('#treeview').treeview(options);

        $('#treeview').treeview('collapseAll', {silent: true});

        function pnode(node) {
            var pnode = $('#treeview').treeview('getParent', node);
            var pid = pnode.id;
            var name = "";
            if (typeof(pid) == "undefined") {
                name += node.text;

            } else {
                var pnode1 = $('#treeview').treeview('getParent', pnode);
                if (typeof(pnode1.id) == "undefined") {
                    name = name + pnode.text + node.text;
                } else {

                    name = name + pnode1.text + pnode.text + node.text;
                }

            }
            return name;
        }
    }

    function getByeHour(hourType, type, cursel, index, queryType) {
        var deviceId = $("#deviceId_" + cursel).val();
        var sign = "";
        if (index == 2) {
            sign = "dl";
        } else if (index == 3) {
            sign = "dy";
        }
        $.ajax({
            url: "rest/pointType/getDataListByHour.do?deviceId=" + deviceId + "&type=" + type + "&hourType=" + hourType + "&queryType=" + queryType,
            success: function (data) {
                //alert(data);
                var data = JSON.parse(data);
                //console.log(data);
                initCharts("main_" + index, data.legend, data.series, data.xData, sign);
            }
        })
    }

    function getOneDay() {

    }
</script>
</body>
<!--[if lt IE 9]>
<script src="assets/global/plugins/respond.min.js"></script>
<script src=assets/global/plugins/excanvas.min.js"></script>
<script src="assets/global/plugins/ie8.fix.min.js"></script>
<![endif]-->
</html>
